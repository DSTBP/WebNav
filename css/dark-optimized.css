/*
 * 优化的夜间模式样式
 * 使用CSS变量 + 硬件加速 + 性能优化
 */

/* CSS变量定义 */
:root {
    --bg-primary: #ffffff;
    --bg-secondary: rgba(255, 255, 255, 0.95);
    --bg-card: rgba(255, 255, 255, 0.9);
    --text-primary: #333333;
    --text-secondary: #666666;
    --border-color: rgba(0, 0, 0, 0.1);
    --shadow-color: rgba(0, 0, 0, 0.1);
    --gradient-start: #667eea;
    --gradient-end: #764ba2;
}

body.dark-theme {
    --bg-primary: #23262b;
    --bg-secondary: rgba(60, 63, 70, 0.95);
    --bg-card: rgba(60, 63, 70, 0.75);
    --text-primary: #e0e0e0;
    --text-secondary: #adb5bd;
    --border-color: rgba(255, 255, 255, 0.1);
    --shadow-color: rgba(0, 0, 0, 0.3);
}

/* 全局过渡动画 - 关键优化 */
body,
.navbar,
.sidebar-menu,
.main-content,
.xe-widget,
.menu-item a,
.box2,
#search-text,
.search-group {
    transition:
        background-color 0.3s cubic-bezier(0.4, 0, 0.2, 1),
        color 0.3s cubic-bezier(0.4, 0, 0.2, 1),
        border-color 0.3s cubic-bezier(0.4, 0, 0.2, 1),
        box-shadow 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    will-change: background-color, color;
}

/* 使用transform代替重绘属性 */
body {
    transform: translateZ(0);
    -webkit-font-smoothing: antialiased;
}

/* 主题色应用 */
body.dark-theme {
    background-color: var(--bg-primary) !important;
    color: var(--text-primary);
}

/* 简化选择器 - 使用直接子选择器 */
.dark-theme .navbar,
.dark-theme .main-content,
.dark-theme .sidebar-menu {
    background: var(--bg-secondary) !important;
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    border-color: var(--border-color);
}

/* Logo区域 */
.dark-theme .logo-env {
    background: linear-gradient(135deg, var(--gradient-start) 0%, var(--gradient-end) 100%);
    box-shadow: 0 8px 32px rgba(102, 126, 234, 0.4);
}

/* 文字颜色统一 */
.dark-theme,
.dark-theme h1, .dark-theme h2, .dark-theme h3, .dark-theme h4,
.dark-theme .user-info-menu a > span,
.dark-theme .xe-user-name strong {
    color: var(--text-primary) !important;
}

.dark-theme .text-gray,
.dark-theme .xe-comment p {
    color: var(--text-secondary) !important;
}

/* 链接 */
.dark-theme a {
    color: #BECFE3;
}

.dark-theme a:hover {
    color: #a5c6fa;
}

/* 菜单项 */
.dark-theme .menu-item a {
    background: transparent !important;
    color: var(--text-primary);
}

.dark-theme .menu-item a:hover {
    background: linear-gradient(135deg, var(--gradient-start) 0%, var(--gradient-end) 100%) !important;
    color: #fff;
    box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
}

/* 卡片 - 优化性能 */
.dark-theme .xe-widget,
.dark-theme .box2 {
    background: var(--bg-card) !important;
    border: 1px solid var(--border-color);
    /* 移除backdrop-filter，性能优化 */
}

.dark-theme .xe-widget:hover,
.dark-theme .box2:hover {
    box-shadow: 0 12px 32px var(--shadow-color);
    transform: translateY(-2px);
}

/* 搜索框 */
.dark-theme #search-text {
    background: var(--bg-card) !important;
    color: var(--text-primary);
    border: 1px solid var(--border-color);
}

.dark-theme #search-text:focus {
    box-shadow: 0 8px 24px rgba(102, 126, 234, 0.3);
}

/* 搜索类型列表 */
.dark-theme .s-type-list {
    background: var(--bg-card) !important;
    border: 1px solid var(--border-color);
}

.dark-theme .search-type li label {
    background: rgba(255, 255, 255, 0.1);
    color: var(--text-primary);
}

.dark-theme .search-type input:checked + label,
.dark-theme .search-type input:hover + label {
    background: linear-gradient(135deg, var(--gradient-start) 0%, var(--gradient-end) 100%) !important;
    color: #fff;
}

/* 侧边栏菜单 */
.dark-theme .sidebar-menu .main-menu a {
    background: rgba(255, 255, 255, 0.1);
    border: 1px solid var(--border-color);
    color: var(--text-primary);
}

.dark-theme .sidebar-menu .main-menu a:hover,
.dark-theme .sidebar-menu .main-menu li.active > a {
    background: linear-gradient(135deg, var(--gradient-start) 0%, var(--gradient-end) 100%);
    color: #fff;
    box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
}

/* 滚动条 */
.dark-theme ::-webkit-scrollbar-thumb {
    background-color: #4a5568;
}

.dark-theme ::-webkit-scrollbar-thumb:hover {
    background-color: var(--gradient-start);
}

/* 特殊颜色修正 */
.dark-theme label[for="type-git"] span,
.dark-theme label[for="type-git1"] span,
.dark-theme label[for="type-links"] span {
    color: var(--text-primary) !important;
}

/* 诗词图标 */
.dark-theme .menu-item .fa-solid.fa-message {
    color: #ffffff !important;
}

/* 性能优化：减少不必要的样式 */
.dark-theme .type-text,
.dark-theme .search-group {
    color: var(--text-primary) !important;
}

/* 禁用不必要的毛玻璃效果（性能优化） */
@media (max-width: 768px) {
    .dark-theme .navbar,
    .dark-theme .main-content,
    .dark-theme .sidebar-menu,
    .dark-theme .xe-widget,
    .dark-theme .box2 {
        backdrop-filter: none;
        -webkit-backdrop-filter: none;
    }
}

/* 减弱动画用户的快速切换 */
@media (prefers-reduced-motion: reduce) {
    body,
    .navbar,
    .sidebar-menu,
    .main-content,
    .xe-widget,
    .menu-item a,
    .box2 {
        transition: none !important;
    }
}
