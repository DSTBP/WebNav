/**
 * 液态金属按钮效果样式
 * 应用于侧边栏切换按钮和回到顶部按钮
 * 基于 metal.css 简化优化，无需外部shader库
 */

/* ====================
   通用液态金属按钮样式
   ==================== */

.liquid-metal-btn {
    position: relative;
    display: flex;
    justify-content: center;
    align-items: center;
    border-radius: 50%;
    cursor: pointer;
    transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
    z-index: 1;
    overflow: visible;
}

/* 金属质感背景 - 简约浅白浅黑 */
.liquid-metal-btn::before {
    content: "";
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 90%;
    height: 90%;
    background: linear-gradient(135deg, #f5f5f5 0%, #e8e8e8 50%, #ddd 100%);
    border-radius: 50%;
    box-shadow:
        inset 0 2px 4px rgba(255, 255, 255, 0.8),
        inset 0 -2px 4px rgba(0, 0, 0, 0.1),
        0 4px 12px rgba(0, 0, 0, 0.1);
    z-index: -1;
    transition: all 0.4s ease;
}

/* 彩色动态边框 - 简约灰色 */
.liquid-metal-btn::after {
    content: "";
    position: absolute;
    inset: -3px;
    padding: 3px;
    border-radius: 50%;
    background: conic-gradient(
        from 180deg,
        #ccc 0deg,
        #aaa 90deg,
        #999 180deg,
        #bbb 270deg,
        #ccc 360deg
    );
    filter: grayscale(0) blur(1px);
    -webkit-mask:
        linear-gradient(#fff 0 0) content-box,
        linear-gradient(#fff 0 0);
    -webkit-mask-composite: xor;
    mask:
        linear-gradient(#fff 0 0) content-box,
        linear-gradient(#fff 0 0);
    mask-composite: exclude;
    opacity: 0.4;
    animation: rotate-border 4s linear infinite;
    z-index: -2;
    transition: all 0.4s ease;
}

/* 悬停效果 */
.liquid-metal-btn:hover::before {
    background: linear-gradient(135deg, #fff 0%, #f5f5f5 50%, #eee 100%);
    box-shadow:
        inset 0 3px 6px rgba(255, 255, 255, 1),
        inset 0 -3px 6px rgba(0, 0, 0, 0.15),
        0 8px 24px rgba(0, 0, 0, 0.15);
    transform: translate(-50%, -50%) scale(1.05);
}

.liquid-metal-btn:hover::after {
    filter: grayscale(0) blur(0);
    opacity: 0.6;
    padding: 4px;
    inset: -4px;
    animation: rotate-border 2s linear infinite;
}

/* 激活效果 */
.liquid-metal-btn:active::before {
    transform: translate(-50%, -50%) scale(0.95);
}

/* 图标样式 */
.liquid-metal-btn .icon {
    position: relative;
    z-index: 1;
    color: #333;
    transition: all 0.3s ease;
    filter: drop-shadow(0 1px 2px rgba(255, 255, 255, 0.8));
}

.liquid-metal-btn:hover .icon {
    color: #000;
    transform: scale(1.1);
    filter: drop-shadow(0 0 4px rgba(0, 0, 0, 0.3));
}

/* 边框旋转动画 */
@keyframes rotate-border {
    0% {
        transform: rotate(0deg);
    }
    100% {
        transform: rotate(360deg);
    }
}

/* ====================
   侧边栏切换按钮专用样式
   ==================== */

#sidebar-toggle-btn.liquid-metal {
    position: fixed;
    left: 0;
    top: 50%;
    transform: translateY(-50%);
    width: 48px;
    height: 48px;
    border-radius: 0 50% 50% 0;
    z-index: 9998;
    transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
}

#sidebar-toggle-btn.liquid-metal::before {
    border-radius: 0 50% 50% 0;
}

/* 侧边栏按钮：禁用旋转边框 */
#sidebar-toggle-btn.liquid-metal::after {
    display: none;
}

/* 侧边栏按钮中的球体 - 增强对比度 */
#sidebar-toggle-btn.liquid-metal span {
    width: 20px;
    height: 20px;
    border-radius: 50%;
    background: radial-gradient(
        circle at 35% 35%,
        #ffffff 0%,
        #f0f0f0 30%,
        #d0d0d0 70%,
        #aaa 100%
    );
    box-shadow:
        0 0 10px rgba(0, 0, 0, 0.2),
        inset 0 2px 4px rgba(255, 255, 255, 1),
        inset 0 -2px 4px rgba(0, 0, 0, 0.15);
    transition: all 0.3s ease;
}

#sidebar-toggle-btn.liquid-metal:hover span {
    transform: scale(1.2);
    box-shadow:
        0 0 16px rgba(0, 0, 0, 0.3),
        0 0 24px rgba(0, 0, 0, 0.15),
        inset 0 2px 4px rgba(255, 255, 255, 1),
        inset 0 -2px 4px rgba(0, 0, 0, 0.2);
}

/* 展开状态 */
#sidebar-toggle-btn.liquid-metal.expanded {
    left: 240px;
}

/* 侧边栏按钮：禁用火花效果 */
#sidebar-toggle-btn.liquid-metal .sparkle {
    display: none !important;
}

/* ====================
   回到顶部按钮专用样式
   ==================== */

#back-to-top.liquid-metal {
    position: fixed;
    right: 30px;
    bottom: 40px;
    width: 56px;
    height: 56px;
    border: none;
    z-index: 9999;
    opacity: 0;
    visibility: hidden;
    transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
}

#back-to-top.liquid-metal.show {
    opacity: 1;
    visibility: visible;
}

#back-to-top.liquid-metal .icon {
    font-size: 24px;
}

/* 特殊效果：上升动画 */
#back-to-top.liquid-metal:hover {
    transform: translateY(-8px);
}

#back-to-top.liquid-metal:active {
    transform: translateY(-4px);
}

/* ====================
   夜间模式适配
   ==================== */

body.dark-theme .liquid-metal-btn::before {
    background: linear-gradient(135deg, #2a2a3a 0%, #1a1a2a 50%, #0a0a1a 100%);
    box-shadow:
        inset 0 2px 4px rgba(255, 255, 255, 0.2),
        inset 0 -2px 4px rgba(0, 0, 0, 0.6),
        0 4px 12px rgba(0, 0, 0, 0.5);
}

body.dark-theme .liquid-metal-btn:hover::before {
    background: linear-gradient(135deg, #3a3a4a 0%, #2a2a3a 50%, #1a1a2a 100%);
    box-shadow:
        inset 0 3px 6px rgba(255, 255, 255, 0.3),
        inset 0 -3px 6px rgba(0, 0, 0, 0.7),
        0 8px 24px rgba(102, 126, 234, 0.5);
}

body.dark-theme .liquid-metal-btn::after {
    background: conic-gradient(
        from 180deg,
        #667eea 0deg,
        #764ba2 90deg,
        #a78bfa 180deg,
        #60a5fa 270deg,
        #667eea 360deg
    );
    filter: grayscale(0.6) blur(1px);
}

body.dark-theme .liquid-metal-btn:hover::after {
    filter: grayscale(0) blur(0);
}

/* ====================
   移动端适配
   ==================== */

@media (max-width: 768px) {
    #sidebar-toggle-btn.liquid-metal {
        width: 40px;
        height: 40px;
    }

    #sidebar-toggle-btn.liquid-metal span {
        width: 16px;
        height: 16px;
    }

    #back-to-top.liquid-metal {
        width: 48px;
        height: 48px;
        right: 20px;
        bottom: 30px;
    }

    #back-to-top.liquid-metal .icon {
        font-size: 20px;
    }
}

/* ====================
   性能优化：减弱动画
   ==================== */

@media (prefers-reduced-motion: reduce) {
    .liquid-metal-btn,
    .liquid-metal-btn::before,
    .liquid-metal-btn::after {
        animation: none !important;
        transition: none !important;
    }
}

/* ====================
   Loading状态
   ==================== */

.liquid-metal-btn.loading::after {
    animation:
        rotate-border 1s linear infinite,
        pulse 2s ease-in-out infinite;
}

@keyframes pulse {
    0%, 100% {
        opacity: 0.6;
    }
    50% {
        opacity: 1;
    }
}

/* ====================
   火花效果（可选增强）
   ==================== */

.liquid-metal-btn .sparkle {
    position: absolute;
    width: 4px;
    height: 4px;
    background: #fff;
    border-radius: 50%;
    opacity: 0;
    animation: sparkle-animation 1.5s ease-in-out infinite;
}

.liquid-metal-btn .sparkle:nth-child(2) {
    animation-delay: 0.3s;
}

.liquid-metal-btn .sparkle:nth-child(3) {
    animation-delay: 0.6s;
}

@keyframes sparkle-animation {
    0% {
        opacity: 0;
        transform: translate(0, 0) scale(0);
    }
    50% {
        opacity: 1;
        transform: translate(10px, -10px) scale(1);
    }
    100% {
        opacity: 0;
        transform: translate(20px, -20px) scale(0);
    }
}
